<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="700" viewBox="0 0 1200 700">

<defs>
  <marker id="a-wh" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#e2e8f0" /></marker>
  <marker id="a-cy" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#22d3ee" /></marker>
  <marker id="a-am" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#fbbf24" /></marker>
  <marker id="a-gn" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#4ade80" /></marker>
  <style>text { font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif; }</style>
  <filter id="glow">
    <feGaussianBlur stdDeviation="2" result="blur"/>
    <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
  </filter>
</defs>

<!-- Background -->
<rect width="1200" height="700" rx="12" fill="#0f172a"/>

<!-- Title -->
<text x="600" y="38" font-size="22" fill="#f1f5f9" text-anchor="middle" font-weight="600">Cross-Region Model Serving Architecture</text>
<text x="600" y="58" font-size="13" fill="#64748b" text-anchor="middle">Delta Sharing (D2D) with Lakebase Online Feature Store</text>

<!-- Unity Catalog governance bar -->
<rect x="30" y="68" width="1140" height="32" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
<text x="600" y="89" font-size="12" fill="#94a3b8" text-anchor="middle">Unity Catalog -- Governance, Lineage, and Access Control</text>

<!-- ============================================================ -->
<!-- PROVIDER WORKSPACE -->
<!-- ============================================================ -->
<rect x="30" y="110" width="460" height="470" rx="10" fill="#1e293b" stroke="#f97316" stroke-width="2"/>
<text x="260" y="138" font-size="18" fill="#fb923c" text-anchor="middle" font-weight="600">Provider Workspace</text>
<text x="260" y="156" font-size="11" fill="#64748b" text-anchor="middle">us-east-1 (Training Region)</text>

<!-- UC Model Registry -->
<rect x="60" y="172" width="400" height="40" rx="6" fill="#1a2744" stroke="#3b82f6" stroke-width="1.5"/>
<text x="260" y="197" font-size="13" fill="#93c5fd" text-anchor="middle">Unity Catalog Model Registry</text>

<!-- Delta Share container -->
<rect x="60" y="228" width="400" height="290" rx="8" fill="#27181a" stroke="#ef4444" stroke-width="1.5" stroke-dasharray="6,3"/>
<text x="260" y="252" font-size="15" fill="#fca5a5" text-anchor="middle" font-weight="600">Delta Share</text>
<text x="260" y="268" font-size="11" fill="#64748b" text-anchor="middle">share_&lt;username&gt;</text>

<!-- Model box -->
<rect x="90" y="285" width="340" height="55" rx="8" fill="#14532d" stroke="#4ade80" stroke-width="1.5"/>
<text x="110" y="307" font-size="11" fill="#86efac" font-weight="600">MODEL</text>
<text x="260" y="328" font-size="14" fill="#dcfce7" text-anchor="middle">catalog.schema.fraud_detector</text>

<!-- Feature Tables box -->
<rect x="90" y="355" width="340" height="55" rx="8" fill="#422006" stroke="#f59e0b" stroke-width="1.5"/>
<text x="110" y="377" font-size="11" fill="#fde68a" font-weight="600">TABLE</text>
<text x="260" y="398" font-size="14" fill="#fef3c7" text-anchor="middle">catalog.schema.user_features</text>

<!-- Python UDFs box -->
<rect x="90" y="425" width="340" height="55" rx="8" fill="#2e1065" stroke="#a78bfa" stroke-width="1.5"/>
<text x="110" y="447" font-size="11" fill="#c4b5fd" font-weight="600">FUNCTION</text>
<text x="260" y="468" font-size="14" fill="#ede9fe" text-anchor="middle">catalog.schema.compute_risk_score</text>

<!-- Dependency arrows inside provider -->
<path d="M 260 355 L 260 340" stroke="#4ade80" fill="none" stroke-width="1.5" stroke-dasharray="4,3" marker-end="url(#a-gn)"/>
<text x="280" y="348" font-size="10" fill="#4ade80">depends on</text>

<!-- model_version_dependencies label -->
<rect x="60" y="498" width="400" height="28" rx="4" fill="#1e293b" stroke="#475569" stroke-width="1"/>
<text x="260" y="517" font-size="11" fill="#94a3b8" text-anchor="middle">Auto-detected via model_version_dependencies API</text>

<!-- Secret scope -->
<rect x="60" y="540" width="190" height="30" rx="5" fill="#1e293b" stroke="#475569" stroke-width="1"/>
<text x="155" y="560" font-size="11" fill="#94a3b8" text-anchor="middle">Secret Scope: target creds</text>

<!-- ============================================================ -->
<!-- D2D SHARING BRIDGE -->
<!-- ============================================================ -->
<rect x="510" y="250" width="180" height="130" rx="10" fill="#172554" stroke="#3b82f6" stroke-width="1.5" filter="url(#glow)"/>
<text x="600" y="278" font-size="14" fill="#93c5fd" text-anchor="middle" font-weight="600">Delta Sharing</text>
<text x="600" y="296" font-size="12" fill="#60a5fa" text-anchor="middle">D2D Protocol</text>
<line x1="535" y1="308" x2="665" y2="308" stroke="#334155" stroke-width="1"/>
<text x="600" y="326" font-size="11" fill="#cbd5e1" text-anchor="middle">Zero-copy (same cloud)</text>
<text x="600" y="342" font-size="11" fill="#cbd5e1" text-anchor="middle">Propagates in seconds</text>
<text x="600" y="362" font-size="11" fill="#cbd5e1" text-anchor="middle">VPC peering (cross-cloud)</text>

<!-- Share arrows -->
<path d="M 460 315 L 510 315" stroke="#e2e8f0" fill="none" stroke-width="2" marker-end="url(#a-wh)"/>
<path d="M 690 315 L 710 315" stroke="#e2e8f0" fill="none" stroke-width="2" marker-end="url(#a-wh)"/>

<!-- Same-metastore label -->
<rect x="522" y="395" width="155" height="40" rx="5" fill="#1e293b" stroke="#475569" stroke-width="1"/>
<text x="600" y="412" font-size="10" fill="#94a3b8" text-anchor="middle">Same metastore: self</text>
<text x="600" y="426" font-size="10" fill="#94a3b8" text-anchor="middle">Cross-metastore: D2D</text>

<!-- ============================================================ -->
<!-- RECIPIENT WORKSPACE -->
<!-- ============================================================ -->
<rect x="710" y="110" width="460" height="495" rx="10" fill="#1e293b" stroke="#06b6d4" stroke-width="2"/>
<text x="940" y="138" font-size="18" fill="#22d3ee" text-anchor="middle" font-weight="600">Recipient Workspace</text>
<text x="940" y="156" font-size="11" fill="#64748b" text-anchor="middle">ap-southeast-1 (Serving Region)</text>

<!-- Shared Catalog (read-only) -->
<rect x="740" y="172" width="400" height="65" rx="8" fill="#164e63" stroke="#06b6d4" stroke-width="1.5"/>
<text x="940" y="196" font-size="14" fill="#a5f3fc" text-anchor="middle" font-weight="600">Shared Catalog (read-only)</text>
<text x="940" y="214" font-size="11" fill="#67e8f9" text-anchor="middle">shared_catalog_&lt;username&gt; -- model + tables + UDFs</text>
<rect x="1060" y="178" width="70" height="20" rx="4" fill="#0e7490" stroke="none"/>
<text x="1095" y="192" font-size="10" fill="#ecfeff" text-anchor="middle">READ-ONLY</text>

<!-- Writable catalog label -->
<rect x="740" y="252" width="400" height="28" rx="4" fill="#1e293b" stroke="#475569" stroke-width="1"/>
<text x="940" y="271" font-size="11" fill="#94a3b8" text-anchor="middle">Writable catalog: main.default (for online tables)</text>

<!-- Lakebase Online Store -->
<rect x="740" y="295" width="400" height="115" rx="8" fill="#3b1a00" stroke="#f59e0b" stroke-width="1.5"/>
<text x="940" y="318" font-size="14" fill="#fde68a" text-anchor="middle" font-weight="600">Lakebase Online Store</text>
<text x="940" y="336" font-size="11" fill="#fef3c7" text-anchor="middle">Capacity: CU_1 | Snapshot sync from shared tables</text>

<!-- Online table inside Lakebase -->
<rect x="770" y="348" width="340" height="46" rx="6" fill="#451a03" stroke="#f59e0b" stroke-width="1"/>
<text x="790" y="368" font-size="10" fill="#fde68a" font-weight="600">ONLINE TABLE</text>
<text x="940" y="386" font-size="12" fill="#fef3c7" text-anchor="middle">main.default.user_features_online</text>

<!-- Arrow: Shared Catalog -> Lakebase -->
<path d="M 940 282 L 940 295" stroke="#22d3ee" fill="none" stroke-width="1.5" marker-end="url(#a-cy)"/>
<text x="955" y="290" font-size="10" fill="#22d3ee">publish_table()</text>

<!-- Table-ID resolution note -->
<rect x="770" y="416" width="150" height="16" rx="3" fill="#1e293b" stroke="none"/>
<text x="845" y="428" font-size="9" fill="#64748b" text-anchor="middle">resolved by table UUID</text>

<!-- Arrow: Lakebase -> Endpoint -->
<path d="M 940 410 L 940 450" stroke="#fbbf24" fill="none" stroke-width="1.5" marker-end="url(#a-am)"/>
<text x="955" y="438" font-size="10" fill="#fbbf24">feature lookup</text>

<!-- Serving Endpoint -->
<rect x="740" y="450" width="400" height="85" rx="8" fill="#450a0a" stroke="#ef4444" stroke-width="1.5"/>
<text x="940" y="476" font-size="14" fill="#fca5a5" text-anchor="middle" font-weight="600">Model Serving Endpoint</text>
<text x="940" y="494" font-size="11" fill="#fecaca" text-anchor="middle">target-fraud-detector-endpoint</text>
<text x="940" y="516" font-size="11" fill="#64748b" text-anchor="middle">scale_to_zero=True | workload_size=Small</text>

<!-- Arrow: Shared Catalog -> Endpoint (model ref) -->
<path d="M 1140 237 L 1155 237 L 1155 490 L 1140 490" stroke="#22d3ee" fill="none" stroke-width="1" stroke-dasharray="5,3" marker-end="url(#a-cy)"/>
<text x="1148" y="370" font-size="10" fill="#22d3ee" transform="rotate(90,1148,370)">model artifact</text>

<!-- Inference call -->
<rect x="740" y="555" width="400" height="35" rx="6" fill="#1e293b" stroke="#475569" stroke-width="1"/>
<text x="940" y="577" font-size="12" fill="#94a3b8" text-anchor="middle">POST /serving-endpoints/.../invocations  {"id": 42}  ->  prediction</text>

<!-- ============================================================ -->
<!-- LEGEND -->
<!-- ============================================================ -->
<rect x="30" y="620" width="1140" height="60" rx="8" fill="#1e293b" stroke="#334155" stroke-width="1"/>
<text x="55" y="642" font-size="11" fill="#94a3b8" font-weight="600">LEGEND:</text>

<!-- Legend items -->
<rect x="130" y="632" width="14" height="14" rx="3" fill="#14532d" stroke="#4ade80" stroke-width="1"/>
<text x="150" y="644" font-size="11" fill="#cbd5e1">Model</text>

<rect x="210" y="632" width="14" height="14" rx="3" fill="#422006" stroke="#f59e0b" stroke-width="1"/>
<text x="230" y="644" font-size="11" fill="#cbd5e1">Feature Table</text>

<rect x="340" y="632" width="14" height="14" rx="3" fill="#2e1065" stroke="#a78bfa" stroke-width="1"/>
<text x="360" y="644" font-size="11" fill="#cbd5e1">Python UDF</text>

<line x1="460" y1="639" x2="500" y2="639" stroke="#e2e8f0" stroke-width="2" marker-end="url(#a-wh)"/>
<text x="510" y="644" font-size="11" fill="#cbd5e1">Data flow</text>

<line x1="590" y1="639" x2="630" y2="639" stroke="#22d3ee" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#a-cy)"/>
<text x="640" y="644" font-size="11" fill="#cbd5e1">Reference</text>

<text x="740" y="644" font-size="11" fill="#64748b">Feature lookup resolves by internal table UUID, not catalog name</text>

<!-- Copyright -->
<text x="600" y="690" font-size="10" fill="#475569" text-anchor="middle">github.com/debu-sinha/cross-region-model-serving-dab</text>
</svg>